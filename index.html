<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>Préremplissage attestation</title>
  </head>

  <body class="bg-light gorgias-loaded">
    <div class="container">
      <div class="py-5 text-center">
        <h1>Préremplissage attestation numérique</h1>
        <p class="lead">
          Utilisez ce formulaire pour générer un bouton pour préremplir automatiquement votre <a href="https://media.interieur.gouv.fr/deplacement-covid-19/">attestation de déplacement numérique</a>.
        </p>
      </div>

      <h4 class="mb-3">Informations à préremplir</h4>

      <label for="firstName">Prénom</label>
      <input type="text" class="form-control mb-2" id="firstName" required="required">

      <label for="lastName">Nom</label>
      <input type="text" class="form-control mb-2" id="lastName" required="required">

      <label for="birthday">Date de naissance</label>
      <input type="text" class="form-control mb-2" id="birthday" required="required" placeholder="jj/mm/aaaa">

      <label for="birthplace">Lieu de naissance</label>
      <input type="text" class="form-control mb-2" id="birthplace" required="required">

      <label for="street">Adresse</label>
      <input type="text" class="form-control mb-2" id="street" required="required">

      <label for="street">Ville</label>
      <input type="text" class="form-control mb-2" id="city" required="required">

      <label for="zip">Code postal</label>
      <input type="text" class="form-control mb-4" id="zip" required="required">

      <button class="btn btn-primary btn-lg btn-block mb-5" type="button" id="button">
        <i class="fa fa-flash mr-2"></i>
        Générer le lien de préremplissage
      </button>
      <div class="alert alert-success text-center" id="linkResultWrapper" style="display: none;">
        <h4 class="mb-3">Voici votre bouton de préremplissage&nbsp;:</h4>
        <a href="#" class="btn btn-success btn-lg mb-3" id="linkResult" style="cursor: move;"></a>
        <p>Déplacez ce bouton dans votre barre de favoris.<br>
          Puis rendez-vous sur <a href="https://media.interieur.gouv.fr/deplacement-covid-19/">la page du gouvernement</a> et cliquez sur le favoris créé.</p>
      </div>
    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script>
      var $firstName = $('#firstName');
      var $lastName = $('#lastName');
      var $birthday = $('#birthday');
      var $birthplace = $('#birthplace');
      var $street = $('#street');
      var $city = $('#city');
      var $zip = $('#zip');

      $('#button').click(function(){
        if ($firstName.val() == '') {
          return;
        }
        $('#linkResultWrapper').show();
        $('#linkResult')
        .attr('href', 'javascript:var d%3Ddocument%3Bfunction i(a)%7Breturn d.getElementById(a)%7Dfunction n(a)%7Breturn d.getElementsByName(a)%5B0%5D%7Dfunction e(a)%7Bt%3D%27change%27%3Bif(window.navigator.userAgent.match(/Trident%7CMSIEs/g)!%3Dnull)%7Bx%3Dd.createEvent(%27Events%27)%3Bx.initEvent(t,1,0)%3B%7Delse%7Bx%3Dnew Event(t)%3B%7Da.dispatchEvent(x)%3B%7Dfunction v(a,v)%7Ba.value%3Dv%3Be(a)%7Dfunction c(a)%7Ba.checked%3Dtrue%3Be(a)%7Dv(i("field-firstname"),"' + $firstName.val() + '")%3Bv(i("field-lastname"),"' + $lastName.val() + '")%3Bv(i("field-birthday"),"' + $birthday.val() + '")%3Bv(i("field-lieunaissance"),"' + $birthplace.val() + '")%3Bv(i("field-address"),"' + $street.val() + '")%3Bv(i("field-town"),"' + $city.val() + '")%3Bv(i("field-zipcode"),"' + $zip.val() + '")%3Bvoid(0)%3B')
        .html('<i class="fa fa-star-o mr-2"></i> Préremplissage ' + $firstName.val())
        .click(function(e){
          e.preventDefault();
          alert('Faites glisser ce bouton dans votre barre de favoris.')
        });
      });
    </script>
  </body>
</html>
